---
title: '<span style="color:darkblue">Tarea: Peak-calling choices</span>'
author: "Amaranta Manrique de Lara y Ramirez, Claudia Saraí Reyes Ávila, Valeria Erendira Mateo Estrada"
date: "24 de febrero de 2016"
output: html_document
---

##<span style="color:blue">Introducción</span>

El método de **ChIP-seq** es utilizado para localizar sitios de unión para factores de transcripción o marcas en la cromatina a lo largo de todo el genoma^[1]^. Éste se caracteriza por combinar dos poderosas herramientas: la inmunoprecipitación de la cromatina y las nuevas tecnologías de secuenciación masiva^[2]^.Posterior a la secuenciación se mapean las lecturas contra un genoma de referencia. Los picos de ChIP-Seq son las regiones ricas en lecturas y pueden obtenerse mediante el uso de algoritmos peak-calling, como por ejemplo **MACS** y **SWEMBL**. Los picos de ChIP-seq proporcionan información precisa sobre la localización de los sitios de unión de promotores y reflejan la diversidad de los sitios. 

La amplitud y número de los picos dependen del peak-caller utilizado. La evaluación de los picos encontrados requiere de la selección de varios criterios. Entre los criterios se encuentran: significancia, enriquecimiento del motivo de referencia, concentración del motivo de referencia y de los motivos encontrados en el centro de los picos y relevancia biológica. RSAT es un sitio web que provee herramientas diseñadas específicamente para la detección de elementos regulatorios en secuencias no codificantes^[3]^.

A pesar de ser un método ampliamente utilizado en la investigación de organismos modelo, regulación génica, desarrollo, enfermedades y vías biológicas; puede llegar a tener grandes variaciones en la interpretación de resultados de acuerdo a la metodología que se haya empleado, los criterios utilizados y sus valores asignados. No obstante, también hay una gran diversidad  de formas en la que se puede evaluar la calidad del experimento^[4]^.

En este trabajo se abordarán dos criterios de control de calidad para los resultados de estos experimentos realizados para el factor **FNR** en *Escherichia coli*: consistencia y comparación con un golden standard. 

**Consistencia** se refiere a qué tan conservados están los resultados de diferentes análisis y con diferentes parámetros. Finalmente, la comparación con un **golden standard** es el uso de un set de datos disponibles y evaluar la sensibilidad del experimento, es decir, los verdaderos positivos o cuántos motivos inferidos realmente son motivos. 

##<span style="color:blue">Métodos</span>

El conjunto de datos fue obtenido de los de ***Escherichia coli*** disponibles en el servidor *tepeu*. Ya que se pretendía comparar los métodos, se eligió al menos un archivo FASTA de cada método: **MACS** y **SWEMBL**. Se tomaron muestras representativas de cada método según los parámetros en los que divergían: los valores R en el caso de SWEMBL, y los valores *q* para MACS. 

Además de los datos de *E. coli* descargados, se corrieron dos controles: uno negativo para MACS, uno negativo para SWEMBL.

Se escogieron como criterios de medida: consistencia y el golden standard.

Para el análisis de consistencia y comparación con el golden standard, se realizaron pasos previos:

	+ Uso de la herramienta ***peak-motifs***.
	+ Visualización de los resultados en la sección __**Discovered motifs**__.
	+ Descarga de matrices en formato **TRANSFAC**.
	
A continuación se presentan los pasos para el análisis de criterios de medida. 

1. Consistencia:
	+ Uso de la herramienta ***matrix-clustering*** con las matrices obtenidas en el paso anterior. 
	+ Visualización de los clústeres de motivos. 
2. Golden standard: 
  	+ Descarga de los motivos de unión a DNA reportados para FNR en **RegulonDB**. 

Para los controles negativos, se hizo un paso previo con la herramienta ***random genome fragments***.

##<span style="color:blue">Resultados</span>

A continuación se presentan los resultados de cada uno de los criterios. 

###<span style="color:lightblue">Consistencia</span>

De los resultados de matrix-clustering, decidimos eliminar los clústeres en los que se anidaban motivos encontrados en los controles negativos. Asumimos que si un motivo predicho es similar a un control negativo, entonces es un falso positivo. De esta manera redujimos el número de clústeres a únicamente 13 que se presentan en el material sumplemetario (Figuras 2.1-13). 

Para comparar entre MACS y SWEMBL un primer criterio es ver en cuántos de los clústeres significativos se encuentran representados los motivos de las diferentes condiciones. Pudimos observer que tanto MACS q0.0001 como SWEMBL R0.1 están representados en 8 de los 13 clústeres, mientras que MACS q0.01 y SWEMBL R0.5 se encuentran en 7. Finalmente, tanto MACS q0.1 y SWEMBL R0.05 aparecen únicamente en 6. 

Otro punto de comparación es si hay clústeres donde haya sólo resultados de MACS o sólo resultados de SWEMBL. Por ejemplo, el clúster 3 (Figura 2.lo que estoy viendo es que  creo que MACS es más sensible o al menos está detectando más motivos que no son detectados con SWEMBL
y a diferentes valores de R se afecta la longitud del motivo



###<span style="color:lightblue">Golden standard</span>

* * * * * * 

##<span style="color:blue">Conclusiones y perspectivas</span>




* * * * * * 

##<span style="color:blue">Material suplementario</span>

Aquí se presenta una lista de fuentes de datos y comandos con afán de facilitar la reproductibilidad del estudio. 

Además, se presentan imágenes de los resultados discutidos en el trabajo. 

###<span style="color:lightblue">Fuentes de datos</span>

Acceso directo a las coordenadas de los picos del caso de estudio (GEO Accession):

![GSM1010219][http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM1010219]

![GSM1010224][http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM1010224]

###<span style="color:lightblue">Recursos bioinformáticos utilizados</span>

La siguiente tabla indica las herramientas bioinformáticas utilizadas en el análisis. .

| Acronym | Description | URL | 
|---------|-------------|-----|
| RSAT | Regulatory Sequence Analysis Tools | <http://rsat.eu/> |
|RegulonDB|Base de datos de regulación transcripcional de *E. coli*|<http://regulondb.ccg.unam.mx/>|

###<span style="color:lightblue">Lista de comandos y parámetros</span> 

A continuación se presentan los comandos empleados para producir los resultados. 

####<span style="color:blue">Pasos previos al análisis de criterios</span>

Comandos utilizados con la herramienta peak-motifs. 

SWEMBL R0.5
````
nice -n 19 $RSAT/perl-scripts/peak-motifs  -v 1 -title 'coli_R0.5'  -i $RSAT/public_html/tmp/apache/2016/02/28/peak-motifs.2016-02-28.085627_2016-02-28.085627_thUfzl/peak-motifspeak_seq  -max_seq_len 1000 -markov auto -disco oligos,positions -nmotifs 5  -minol 6 -maxol 7  -no_merge_lengths -2str  -origin center  -motif_db footprintDB tf $RSAT/public_html/motif_databases/footprintDB/footprintDB.motif.tf -motif_db regulonDB tf $RSAT/public_html/motif_databases/REGULONDB/regulonDB_2015-08-07.tf -scan_markov 1 -task purge,seqlen,composition,disco,merge_motifs,split_motifs,motifs_vs_motifs,timelog,archive,synthesis,small_summary,motifs_vs_db,scan -prefix peak-motifs -noov -img_format png  -outdir $RSAT/public_html/tmp/apache/2016/02/28/peak-motifs.2016-02-28.085627_2016-02-28.085627_thUfzl
````
SWEMBL R0.05
````
nice -n 19 $RSAT/perl-scripts/peak-motifs  -v 1 -title 'coli_R0.05'  -i $RSAT/public_html/tmp/apache/2016/02/28/peak-motifs.2016-02-28.085457_2016-02-28.085457_BrQ1lJ/peak-motifspeak_seq  -max_seq_len 1000 -markov auto -disco oligos,positions -nmotifs 5  -minol 6 -maxol 7  -no_merge_lengths -2str  -origin center  -motif_db footprintDB tf $RSAT/public_html/motif_databases/footprintDB/footprintDB.motif.tf -motif_db regulonDB tf $RSAT/public_html/motif_databases/REGULONDB/regulonDB_2015-08-07.tf -scan_markov 1 -task purge,seqlen,composition,disco,merge_motifs,split_motifs,motifs_vs_motifs,timelog,archive,synthesis,small_summary,motifs_vs_db,scan -prefix peak-motifs -noov -img_format png  -outdir $RSAT/public_html/tmp/apache/2016/02/28/peak-motifs.2016-02-28.085457_2016-02-28.085457_BrQ1lJ
````
MACS q0.0001
````
nice -n 19 $RSAT/perl-scripts/peak-motifs  -v 1 -title 'coli_q0.0001'  -i $RSAT/public_html/tmp/apache/2016/02/28/peak-motifs.2016-02-28.085724_2016-02-28.085724_acNjN5/peak-motifspeak_seq  -max_seq_len 1000 -markov auto -disco oligos,positions -nmotifs 5  -minol 6 -maxol 7  -no_merge_lengths -2str  -origin center  -motif_db footprintDB tf $RSAT/public_html/motif_databases/footprintDB/footprintDB.motif.tf -motif_db regulonDB tf $RSAT/public_html/motif_databases/REGULONDB/regulonDB_2015-08-07.tf -scan_markov 1 -task purge,seqlen,composition,disco,merge_motifs,split_motifs,motifs_vs_motifs,timelog,archive,synthesis,small_summary,motifs_vs_db,scan -prefix peak-motifs -noov -img_format png  -outdir $RSAT/public_html/tmp/apache/2016/02/28/peak-motifs.2016-02-28.085724_2016-02-28.085724_acNjN5
````
MACS q0.1
````
nice -n 19 $RSAT/perl-scripts/peak-motifs  -v 1 -title 'coli_q0.1'  -i $RSAT/public_html/tmp/apache/2016/02/28/peak-motifs.2016-02-28.085829_2016-02-28.085829_Z44qCu/peak-motifspeak_seq  -max_seq_len 1000 -markov auto -disco oligos,positions -nmotifs 5  -minol 6 -maxol 7  -no_merge_lengths -2str  -origin center  -motif_db footprintDB tf $RSAT/public_html/motif_databases/footprintDB/footprintDB.motif.tf -motif_db regulonDB tf $RSAT/public_html/motif_databases/REGULONDB/regulonDB_2015-08-07.tf -scan_markov 1 -task purge,seqlen,composition,disco,merge_motifs,split_motifs,motifs_vs_motifs,timelog,archive,synthesis,small_summary,motifs_vs_db,scan -prefix peak-motifs -noov -img_format png  -outdir $RSAT/public_html/tmp/apache/2016/02/28/peak-motifs.2016-02-28.085829_2016-02-28.085829_Z44qCu
````

####<span style="color:blue">Consistencia</span>

Comandos utilizados con la herramienta matrix-clustering
````
matrix-clustering  -v 1 -max_matrices 300 -matrix_format transfac -i $RSAT/public_html/tmp/www-data/2016/03/08/matrix-clustering_2016-03-08.205527_oGqE7i/matrix-clustering_query_matrices.transfac -hclust_method average -calc sum -title coli_peak-motifs_all_motifs -metric_build_tree Ncor -lth w 5 -lth cor 0.75 -lth Ncor 0.55 -label_in_tree name -return json,heatmap -o $RSAT/public_html/tmp/www-data/2016/03/08/matrix-clustering_2016-03-08.205527_oGqE7i/matrix-clustering
````

####<span style="color:blue">Golden Standard</span>

Comandos utilizados con la herramienta retrieve sequence a partir de datos de FNR en RegulonDB

Control positivo 
````
$RSAT/perl-scripts/retrieve-seq  -org Escherichia_coli_K_12_substr__MG1655_uid57779 -feattype gene -type upstream -format fasta -label name -from -1 -to -400 -noorf  -rm  -i $RSAT/public_html/tmp/apache/2016/03/09/retrieve-seq_2016-03-09.202443_wNR7La.genes
````

Comandos utilizados con la herramienta random sequences

Control negativo
````
$RSAT/perl-scripts/random-seq  -template_format len -i $RSAT/public_html/tmp/apache/2016/03/09/random-seq_2016-03-09.203040_bm0KQ8.lengths -lw 50 -format fasta  -bg upstream-noorf -org Escherichia_coli_K_12_substr__MG1655_uid57779 -ol 6 -type dna
````

###<span style="color:lightblue">Figuras</span> 

####<span style="color:blue">Consistencia</span>
Figura 2.1
![Figura 2.1](C:\Users\USUARIO\Documents\TODO - Lenovo backup\LCG\Semestre IV\Bioinformática\Jacques van Helden\peak-calling\cluster03.jpg)
Figura 2.2
![Figura 2.2](C:\Users\USUARIO\Documents\TODO - Lenovo backup\LCG\Semestre IV\Bioinformática\Jacques van Helden\peak-calling\cluster04.jpg)
Figura 2.3 
![Figura 2.3](C:\Users\USUARIO\Documents\TODO - Lenovo backup\LCG\Semestre IV\Bioinformática\Jacques van Helden\peak-calling\cluster05.jpg)
Figura 2.4 
![Figura 2.4](C:\Users\USUARIO\Documents\TODO - Lenovo backup\LCG\Semestre IV\Bioinformática\Jacques van Helden\peak-calling\cluster06.jpg)
Figura 2.5 
![Figura 2.5](C:\Users\USUARIO\Documents\TODO - Lenovo backup\LCG\Semestre IV\Bioinformática\Jacques van Helden\peak-calling\cluster07.jpg)
Figura 2.6 
![Figura 2.6](C:\Users\USUARIO\Documents\TODO - Lenovo backup\LCG\Semestre IV\Bioinformática\Jacques van Helden\peak-calling\cluster08.jpg)
Figura 2.7 
![Figura 2.7](C:\Users\USUARIO\Documents\TODO - Lenovo backup\LCG\Semestre IV\Bioinformática\Jacques van Helden\peak-calling\cluster09.jpg)
Figura 2.8 
![Figura 2.8](C:\Users\USUARIO\Documents\TODO - Lenovo backup\LCG\Semestre IV\Bioinformática\Jacques van Helden\peak-calling\cluster16.jpg)
Figura 2.9 
![Figura 2.9](C:\Users\USUARIO\Documents\TODO - Lenovo backup\LCG\Semestre IV\Bioinformática\Jacques van Helden\peak-calling\cluster17.jpg)
Figura 2.10 
![Figura 2.10](C:\Users\USUARIO\Documents\TODO - Lenovo backup\LCG\Semestre IV\Bioinformática\Jacques van Helden\peak-calling\cluster19.jpg)
Figura 2.11 
![Figura 2.11](C:\Users\USUARIO\Documents\TODO - Lenovo backup\LCG\Semestre IV\Bioinformática\Jacques van Helden\peak-calling\cluster21.jpg)
Figura 2.12 
![Figura 2.12](C:\Users\USUARIO\Documents\TODO - Lenovo backup\LCG\Semestre IV\Bioinformática\Jacques van Helden\peak-calling\cluster22.jpg)
Figura 2.13 
![Figura 2.13](C:\Users\USUARIO\Documents\TODO - Lenovo backup\LCG\Semestre IV\Bioinformática\Jacques van Helden\peak-calling\cluster23.jpg)

####<span style="color:blue">Golden standard</span>

***

####<span style="color:darkblue">Referencias</span>

^[1]^ J Castro-Mondragon, C Rioualen, B Contreras-Moreira, J van Helden (2016) [RSAT::Plants: motif discovery in ChIP-seq peaks of plant genomes](http://cursos.lcg.unam.mx/claroline/document/goto/?url=%2FJacques_van-Helden_BEII_2016%2FRSAT_protocols_for_students_only%2Fchapter_RSAT_plant_ChIP-seq_motifs.html&cidReq=BE2_2016#data-sources).

^[2]^ Illumina. [Precise analysis of DNA-protein binding sequences: Combining chromatin immunoprecipitation with NGS for genome-wide surveys of gene regulation](http://www.illumina.com/techniques/sequencing/dna-sequencing/chip-seq.html).

^[3]^[Regulatory Sequence Analysis Tools (RSAT)](http://embnet.ccg.unam.mx/rsa-tools/)

* A Medina-Rivera, M Defrance, O Sand, C Herrmann, J Castro-Mondragon, J Delerce, S Jaeger, C Blanchet, P Vincens, C Caron, DM Staines, B Contreras-Moreira, M Artufel, L Charbonnier-Khamvongsa, C Hernandez, D Thieffry, M Thomas-Chollier, J van Helden J (2015) RSAT 2015: Regulatory Sequence Analysis Tools . Nucleic Acids Res. 

* M Thomas-Chollier, M Defrance, A Medina-Rivera, O Sand, C Herrmann, D Thieffry,  van Helden (2011) RSAT 2011: regulatory sequence analysis tools. Nucleic Acids Res.

* M Thomas-Chollier, O Sand, JV Turatsinze, R Janky, M Defrance, E Vervisch, S Brohee, J van Helden (2008) RSAT: regulatory sequence analysis tools. Nucleic Acids Res. 

* J van Helden (2003) Regulatory sequence analysis tools. Nucleic Acids Res. 

^[4]^ SG Landt, GK Marinov, A Kundaje, et al. (2012) [ChIP-seq guidelines and practices of the ENCODE and modENCODE consortia](http://www.ncbi.nlm.nih.gov/pmc/articles/PMC3431496/). Genome Research 22(9): 1813-1831.

* * * * * * *




